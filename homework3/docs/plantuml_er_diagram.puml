@startuml plantuml_er_diagram

' Styling
skinparam linetype ortho
skinparam class {
    BackgroundColor White
    ArrowColor Black
    BorderColor Black
}

entity "raw_spots" as raw {
    * id : INTEGER <<PK>>
    --
    * timestamp : TIMESTAMP
    * raw_text : TEXT
}

entity "dx_spots" as spots {
    * id : INTEGER <<PK>>
    --
    * raw_spot_id : INTEGER <<FK>>
    * timestamp : TIMESTAMP
    * dx_call : VARCHAR(20)
    * frequency : NUMERIC(10,3)
    * spotter_call : VARCHAR(20)
    comment : TEXT
    mode : VARCHAR(10)
    signal_report : VARCHAR(10)
    grid_square : VARCHAR(6)
    band : VARCHAR(10)
}

entity "callsigns" as calls {
    * id : INTEGER <<PK>>
    --
    * callsign : VARCHAR(20) <<unique>>
    * first_seen : TIMESTAMP
    * last_seen : TIMESTAMP
    * total_spots : INTEGER
    * total_spotted : INTEGER
}

' Relationships
raw ||--o{ spots : "raw_spot_id"
spots }o--|| calls : "dx_call"
spots }o--|| calls : "spotter_call"

note bottom of raw
  Stores original, unmodified
  DX spot messages as received
end note

note bottom of spots
  Contains parsed spot data with
  structured fields for querying
end note

note bottom of calls
  Tracks statistics for all callsigns,
  both spotters and spotted stations
end note

@enduml